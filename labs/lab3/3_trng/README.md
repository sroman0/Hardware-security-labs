## True Random Number Generator

The LFSR can be used to generate a pseudo-random sequence. However, the sequence generated by an LFSR is deterministic and will repeat after a certain number of cycles. This is not suitable for cryptographic applications where true randomness is required. One way to improve the randomness of the sequence generated by an LFSR is to use a True Random Number Generator (TRNG) to seed the LFSR. A TRNG generates random numbers from physical processes.

Intel provides different assembler instructions to generate random numbers: RDSEED and RDRAND. RDSEED is a true random number generator that uses a hardware entropy source to generate random numbers. RDRAND is a pseudo-random number generator that uses a hardware entropy source to generate random numbers.

### Implementation

Before using the functions, you need to check if the CPU supports the instructions. This can be done by checking the CPUID instruction. The CPUID instruction returns information about the CPU. The CPUID instruction is used to determine the state of the registers EAX, EBX, ECX, and EDX.

To be specific, support for RDRAND can be checked by checking the bit 30 of the ECX register returned by the CPUID, meanwhile support for RDSEED can be checked by checking the bit 18 of the EBX register returned by the CPUID. In the following code, the CPUID instruction is used to check if the CPU supports the RDRAND and RDSEED instructions.
 - In the the `drng.c` and `drng.h` files you will find the following functions:
  - `void cpuid(cpuid_t *info, unsigned int leaf, unsigned int subleaf)`
  - `int _is_intel_cpu();`
- `void get_drng_support(dnrg_t *has_rdrand, dnrg_t *has_rdseed)`

- Create a new file called `trng.h` and `trng.c`, and implement the following function:
- `int get_true_random_number(unsigned int *result, dnrg_t drng_support)`
  - This function should return a random number generated by the RDSEED or by the RDRAND instruction with the following requirements:
    1. If your CPU does not support the instructions, the function should return -1.
    2. If your CPU supports both instructions, use the RDSEED instruction.
    3. If your CPU supports only the RDRAND instruction, use the RDRAND instruction.
    4. In order to use the RDSEED or RDRAND instruction, you need to include the `<immintrin.h>` header file.
    5. For generating a RDSEED or RDRAND instruction, you need to use the `_rdseed32_step()` or `_rdrand32_step()` functions. These functions return 1 if the instruction was successful, 0 otherwise.
    6. Your function should try to generate a random number 10 times. If the instruction fails 10 times, the function should return -1.
- Create a new file called `main.c` and call the function `get_true_random_number()` and print 100 random numbers.
- Compile the code using the following command: `gcc -o trng trng.c dnrg.c main.c -mrdrand -mrdseed`

- - -

- [Next-LFSR with TRNG Seed](../4_lfsr_trng/README.md)
- [Previous-Linear Feedback Shift Register (LFSR)](../2_lfsr/README.md)
- [Main](../README.md) - Overview of the project and its contents
